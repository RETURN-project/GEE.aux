context("Tidy data")

test_that("Straight line time series", {
  x <- c("[0, 439, [-53.004852639397384, -25.47331038757392], ['1_1_1_LC08_222078_20130408_NBR', '1_1_1_LC08_223078_20130403_NBR', '1_1_1_LC08_223078_20140527_NBR'], [0.7262472885032538, None, 0.7234786663557939], ['20010101-ESACCI-L3S_FIRE-BA-MODIS-AREA_2-fv51-JD_b1', '20010201-ESACCI-L3S_FIRE-BA-MODIS-AREA_2-fv51-JD_b1', '20010301-ESACCI-L3S_FIRE-BA-MODIS-AREA_2-fv51-JD_b1'], [0, 1, 0], ['20010101-ESACCI-L3S_FIRE-BA-MODIS-AREA_2-fv51-CL_b1', '20010201-ESACCI-L3S_FIRE-BA-MODIS-AREA_2-fv51-CL_b1', '20010301-ESACCI-L3S_FIRE-BA-MODIS-AREA_2-fv51-CL_b1'],[1, 53, 1]]",
         "[0, 439, [-53.004852639397384, -25.47331038757392], ['1_1_1_LC08_222078_20130408_NBR', '1_1_1_LC08_223078_20130403_NBR', '1_1_1_LC08_223078_20140527_NBR'], [0.7262472885032538, None, 0.7234786663557939], ['20010101-ESACCI-L3S_FIRE-BA-MODIS-AREA_2-fv51-JD_b1', '20010201-ESACCI-L3S_FIRE-BA-MODIS-AREA_2-fv51-JD_b1', '20010301-ESACCI-L3S_FIRE-BA-MODIS-AREA_2-fv51-JD_b1'], [0, 1, 0], ['20010101-ESACCI-L3S_FIRE-BA-MODIS-AREA_2-fv51-CL_b1', '20010201-ESACCI-L3S_FIRE-BA-MODIS-AREA_2-fv51-CL_b1', '20010301-ESACCI-L3S_FIRE-BA-MODIS-AREA_2-fv51-CL_b1'],[1, 53, 1]]",
         "[0, 440, [-53.004852639397384, -25.47331038757392], ['1_1_1_LC08_222078_20130408_NBR', '1_1_1_LC08_223078_20130403_NBR', '1_1_1_LC08_223078_20140527_NBR'], [0.7262472885032538, None, 0.7234786663557939], ['20010101-ESACCI-L3S_FIRE-BA-MODIS-AREA_2-fv51-JD_b1', '20010201-ESACCI-L3S_FIRE-BA-MODIS-AREA_2-fv51-JD_b1', '20010301-ESACCI-L3S_FIRE-BA-MODIS-AREA_2-fv51-JD_b1'], [1, 5, 6], ['20010101-ESACCI-L3S_FIRE-BA-MODIS-AREA_2-fv51-CL_b1', '20010201-ESACCI-L3S_FIRE-BA-MODIS-AREA_2-fv51-CL_b1', '20010301-ESACCI-L3S_FIRE-BA-MODIS-AREA_2-fv51-CL_b1'],[10, 55, 18]]")
  # column names of the data
  col_names <- c("id","ecoReg","coords","img_names","series","img_doy_","doy_fire_","img_conf_","conf_fire_")
  # generate a dataframe from the input data
  dat_tidy <- tidy_data(x,col_names)

  expect_equal(dat_tidy$ecoReg, c('439','440'), tolerance = 1e-6)
  expect_equal(dat_tidy$conf_fire_, c('1, 53, 1','10, 55, 18'), tolerance = 1e-6)
  expect_equal(dat_tidy$doy_fire_, c('0, 1, 0','1, 5, 6'), tolerance = 1e-6)
})
